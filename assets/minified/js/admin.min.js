(()=>{"use strict";const e=window.React,{i18n:{__},components:{Button:t,Tooltip:o,Icon:a}}=wp,l=({formData:l})=>{const{icon:{viewBox:n="0 0 512 512",paths:r=["M257.5 27.6c-.8-5.4-4.9-9.8-10.3-10.6v0c-22.1-3.1-44.6 .9-64.4 11.4l-74 39.5C89.1 78.4 73.2 94.9 63.4 115L26.7 190.6c-9.8 20.1-13 42.9-9.1 64.9l14.5 82.8c3.9 22.1 14.6 42.3 30.7 57.9l60.3 58.4c16.1 15.6 36.6 25.6 58.7 28.7l83 11.7c22.1 3.1 44.6-.9 64.4-11.4l74-39.5c19.7-10.5 35.6-27 45.4-47.2l36.7-75.5c9.8-20.1 13-42.9 9.1-64.9v0c-.9-5.3-5.3-9.3-10.6-10.1c-51.5-8.2-92.8-47.1-104.5-97.4c-1.8-7.6-8-13.4-15.7-14.6c-54.6-8.7-97.7-52-106.2-106.8zM208 144a32 32 0 1 1 0 64 32 32 0 1 1 0-64zM144 336a32 32 0 1 1 64 0 32 32 0 1 1 -64 0zm224-64a32 32 0 1 1 0 64 32 32 0 1 1 0-64z"]}={}}=l;return(0,e.createElement)(o,{text:__("Preview","wecodeart")},(0,e.createElement)(t,{style:(({position:e,style:{padding:t,border:o={},borderRadius:a,width:l,height:n,left:r="initial",right:c="initial",bottom:s=0,backgroundColor:i="transparent",color:d="inherit"}={}}={})=>{let m={position:"fixed",bottom:s,width:l,height:n,padding:t,color:d,borderRadius:a,backgroundColor:i,left:"left"===e?r:"initial",right:"right"===e?r:"initial",transition:"all .3s ease-in-out",zIndex:1e3},p={};const g=Object.keys(o);if(["top","left","right","bottom"].some((e=>g.includes(e))))for(const e in o){const t=o[e];p={...p,[`border${capitalizeWord(e)}`]:Object.values(t).join(" ")}}else p={border:Object.values(o).join(" ")};return m={...m,...p},m})(l)},(0,e.createElement)(a,{icon:()=>(0,e.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:n},r.map((t=>(0,e.createElement)("path",{fill:"currentColor",d:t}))))})))},{i18n:{__:n},components:{Modal:r,Spinner:c,Button:s,TextareaControl:i,ToggleControl:d},element:{useRef:m,useState:p}}=wp,g=({progress:t=0})=>(0,e.createElement)(e.Fragment,null,(0,e.createElement)("div",{style:{border:"1px solid lightgrey",borderRadius:5,overflow:"hidden"}},(0,e.createElement)("div",{style:{backgroundColor:"var(--wp-admin-theme-color)",height:14,width:`${t}%`}}))),u=({formData:t,setFormData:o,closeModal:a,createNotice:l})=>{const[u,w]=p(0),[b,h]=p(null),[f,E]=p(null),v=m(null),k=async e=>{const t=new FormData(v.current);t.append("scan",f?"all":"last"),t.append("page",e);const o=await fetch(`${wecodeart.restUrl}/scan_cookies`,{method:"POST",body:t}),{cookies:a=[],progress:r,next:c}=await o.json();if(c)w(r),await k(c);else{h(!1),w(100);const e=Object.values(a).flat().length;l("success",sprintf(n("%s detected cookie(s) added to list.","wecodeart"),e))}};return(0,e.createElement)(r,{title:n("Scan cookies","wecodeart"),onRequestClose:a},(0,e.createElement)("form",{name:"wecodeart-cookies-scan",ref:v},(0,e.createElement)("div",{className:"components-notice is-warning flex-column align-items-start m-0 mb-3"},(0,e.createElement)("ul",{class:"my-0"},(0,e.createElement)("li",{class:"mb-0"},n("Scan your website for server-side cookies (set with setcookie).","wecodeart")),(0,e.createElement)("li",{class:"mb-0"},n("Note that all cookies will be automatically detected on page load.","wecodeart")),f&&(0,e.createElement)("li",{class:"mb-0"},n("Scanning all URLs will take significantly longer.","wecodeart")))),(0,e.createElement)(d,{label:n("Full scan?","wecodeart"),name:"scan",checked:f,onChange:()=>E(!f),help:sprintf(n("Scan %s for each post type.","wecodeart"),n(f?"all urls":"last url","wecodeart"))}),(0,e.createElement)(i,{label:n("Additional URLs to scan","wecodeart"),name:"urls",cols:"50",value:t.scan,onChange:e=>o({...t,scan:e}),help:n("One per line - save settings for future scans.","wecodeart")}),(0,e.createElement)(s,{className:"button d-flex gap-2",isPrimary:!0,icon:b&&(0,e.createElement)(c,{style:{margin:0}}),onClick:async()=>{h(!0),w(0),await k(1)},disabled:b},n(b?"Scaning cookies":"Scan cookies","wecodeart")),b&&(0,e.createElement)("p",null,(0,e.createElement)(g,{progress:u}))))},{i18n:{__:w,_x},hooks:{addFilter:b},components:{Placeholder:h,Card:f,CardHeader:E,CardBody:v,Spinner:k,Button:C,Notice:y,TextControl:x,BaseControl:N,RangeControl:S,DropdownMenu:_,SelectControl:P,ToggleControl:M,ColorPalette:B,ColorIndicator:T,__experimentalHStack:R,__experimentalNumberControl:O,__experimentalBorderBoxControl:j},element:{useState:A},blockEditor:{useSetting:D}}=wp,I=(e={})=>{const t=new URL(`${wecodeart.adminUrl}/site-editor.php`);return Object.keys(e).map((o=>t.searchParams.append(o,e[o]))),t.toString()};b("wecodeart.admin.tabs.plugins","wecodeart/cookies/admin/panel",(function(t){return[...t,{name:"wca-cookies",title:w("Cookies","wecodeart"),render:t=>(0,e.createElement)(z,{...t})}]}));const z=t=>{const{settings:o,saveSettings:a,isRequesting:n,createNotice:r}=t;if(n||!o)return(0,e.createElement)(h,{icon:(0,e.createElement)(k,null),label:w("Loading","wecodeart"),instructions:w("Please wait, loading settings...","wecodeart")});const c=(({cookies:e})=>e)(o),[s,i]=A(null),[d,m]=A(c),[p,g]=A(!1),b=(e={},t="offcanvas")=>{const o={...d?.[t]?.style,...e};m({...d,[t]:{...d?.[t],style:o}})},z=()=>(i(!1),r("success",w("Settings saved.","wecodeart"))),H=D("color.palette");return(0,e.createElement)(e.Fragment,null,!1!==d.notice&&(0,e.createElement)(y,{status:"info",className:"border-top border-bottom border-end mb-3",onRemove:()=>m({...d,notice:!1})},(0,e.createElement)("p",{className:"my-0",dangerouslySetInnerHTML:{__html:sprintf(_x("You can edit module messages/templates under %s.","wecodeart"),`<a href="${I({path:"/patterns",categoryType:"wp_template_part",categoryId:"wca-cookies"})}" target="_blank">${w("Site Editor","wecodeart")}</a>`)}})),(0,e.createElement)("div",{className:"grid",style:{"--wca--columns":2}},(0,e.createElement)("div",{className:"g-col-2"},(0,e.createElement)(f,{className:"border shadow-none h-100"},(0,e.createElement)(E,null,(0,e.createElement)("h5",{className:"text-uppercase fw-medium m-0"},w("Cookies","wecodeart")),(0,e.createElement)(C,{className:"button",onClick:()=>g(!0)},w("Detect cookies","wecodeart"))),(0,e.createElement)(v,{style:{color:"rgb(30, 30, 30)"}},(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Block cookies","wecodeart"),checked:d?.cookies?.block,onChange:e=>m({...d,cookies:{...d?.cookies,block:e}}),help:sprintf(w("Cookies are %s until accepted.","wecodeart"),w(d?.cookies?.block?"blocked":"not blocked","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(O,{label:w("Expiration","wecodeart"),value:d?.cookies?.expire,onChange:e=>m({...d,cookies:{...d?.cookies,expire:e}}),help:w("Duration for cookie accept|reject - in days.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(x,{label:w("Necessary cookies","wecodeart"),value:d?.cookies?.necessary,onChange:e=>m({...d,cookies:{...d?.cookies,necessary:e}}),help:w("These cookies are stictly necessary and website cannot function properly without them.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(x,{label:w("Necessary cookies prefix","wecodeart"),value:d?.cookies?.necessaryPrefix,onChange:e=>m({...d,cookies:{...d?.cookies,necessaryPrefix:e}}),help:w("Cookies starting with these prefixes will also be considered necessary.","wecodeart")}))))),(0,e.createElement)("div",{className:"g-col-1"},(0,e.createElement)(f,{className:"border shadow-none h-100"},(0,e.createElement)(E,null,(0,e.createElement)("h5",{className:"text-uppercase fw-medium m-0"},w("Offcanvas","wecodeart"))),(0,e.createElement)(v,{style:{color:"rgb(30, 30, 30)"}},(0,e.createElement)("p",null,(0,e.createElement)(P,{label:w("Position","wecodeart"),value:d?.offcanvas?.position,options:[{label:w("Top","wecodeart"),value:"top"},{label:w("Bottom","wecodeart"),value:"bottom"}],onChange:e=>m({...d,offcanvas:{...d?.offcanvas,position:e}}),help:w("Relative to the browser window.","wecodeart"),__nextHasNoMarginBottom:!0})),(0,e.createElement)("p",null,(0,e.createElement)(x,{label:w("Title","wecodeart"),value:d?.offcanvas?.title,onChange:e=>m({...d,offcanvas:{...d?.offcanvas,title:e}}),help:w("The title for the offcanvas.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(P,{label:w("Backdrop","wecodeart"),value:d?.offcanvas?.backdrop,options:[{label:w("Enabled","wecodeart"),value:"true"},{label:w("Static","wecodeart"),value:"static"},{label:w("Disabled","wecodeart"),value:"false"}],onChange:e=>m({...d,offcanvas:{...d?.offcanvas,backdrop:e}}),help:"false"!==d?.offcanvas?.backdrop&&sprintf(w("Clicking backdrop will %s offcanvas.","wecodeart"),w("static"===d?.offcanvas?.backdrop?"not close":"close","wecodeart")),__nextHasNoMarginBottom:!0})),(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Allow scroll","wecodeart"),checked:d?.offcanvas?.scroll,onChange:e=>m({...d,offcanvas:{...d?.offcanvas,scroll:e}}),help:sprintf(w("Scroll is %s when offcanvas is active.","wecodeart"),w(d?.offcanvas?.scroll?"allowed":"not allowed","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Show close button","wecodeart"),checked:d?.offcanvas?.close,onChange:e=>m({...d,offcanvas:{...d?.offcanvas,close:e}}),help:sprintf(w("Offcanvas close button is %s.","wecodeart"),w(d?.offcanvas?.close?"shown":"not shown","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Keyboard control","wecodeart"),checked:d?.offcanvas?.keyboard,onChange:e=>m({...d,offcanvas:{...d?.offcanvas,keyboard:e}}),help:sprintf(w("Offcanvas %s be closed with ESC key.","wecodeart"),w(d?.offcanvas?.keyboard?"can":"cannot","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(N,{label:w("Colors","wecodeart")},(0,e.createElement)(R,{style:{justifyContent:"flex-start"}},(0,e.createElement)(_,{label:w("Background Color","wecodeart"),icon:(0,e.createElement)(T,{colorValue:d?.offcanvas?.style?.backgroundColor}),toggleProps:{style:{height:"initial",minWidth:"initial",padding:0}},popoverProps:{focusOnMount:"container",position:"bottom",noArrow:!1}},(()=>(0,e.createElement)(B,{colors:H,enableAlpha:!0,value:d?.offcanvas?.style?.backgroundColor,onChange:e=>b({backgroundColor:e})}))),(0,e.createElement)(_,{label:w("Text Color","wecodeart"),icon:(0,e.createElement)(T,{colorValue:d?.offcanvas?.style?.color}),toggleProps:{style:{height:"initial",minWidth:"initial",padding:0}},popoverProps:{focusOnMount:"container",position:"bottom",noArrow:!1}},(()=>(0,e.createElement)(B,{colors:H,enableAlpha:!0,value:d?.offcanvas?.style?.color,onChange:e=>b({color:e})}))))))))),(0,e.createElement)("div",{className:"g-col-1"},(0,e.createElement)(f,{className:"border shadow-none h-100"},(0,e.createElement)(E,null,(0,e.createElement)("h5",{className:"text-uppercase fw-medium m-0"},w("Modal","wecodeart"))),(0,e.createElement)(v,{style:{color:"rgb(30, 30, 30)"}},(0,e.createElement)("p",null,(0,e.createElement)(P,{label:w("Position","wecodeart"),value:d?.modal?.position,options:[{label:w("Top","wecodeart"),value:"top"},{label:w("Centered","wecodeart"),value:"centered"},{label:w("Custom","wecodeart"),value:"custom"}],onChange:e=>m({...d,modal:{...d?.modal,position:e}}),help:w("Relative to the browser window.","wecodeart"),__nextHasNoMarginBottom:!0})),(0,e.createElement)("p",null,(0,e.createElement)(x,{label:w("Title","wecodeart"),value:d?.modal?.title,onChange:e=>m({...d,modal:{...d?.modal,title:e}}),help:w("The title for the modal.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(P,{label:w("Backdrop","wecodeart"),value:d?.modal?.backdrop,options:[{label:w("Enabled","wecodeart"),value:"true"},{label:w("Static","wecodeart"),value:"static"},{label:w("Disabled","wecodeart"),value:"false"}],onChange:e=>m({...d,modal:{...d?.modal,backdrop:e}}),help:"false"!==d?.modal?.backdrop&&sprintf(w("Clicking backdrop will %s modal.","wecodeart"),w("static"===d?.modal?.backdrop?"not close":"close","wecodeart")),__nextHasNoMarginBottom:!0})),(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Close offcanvas","wecodeart"),checked:d?.modal?.closeOffcanvas,onChange:e=>m({...d,modal:{...d?.modal,closeOffcanvas:e}}),help:sprintf(w("Offcanvas will %s when modal is active.","wecodeart"),w(d?.modal?.closeOffcanvas?"close":"not close","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Show close button","wecodeart"),checked:d?.modal?.close,onChange:e=>m({...d,modal:{...d?.modal,close:e}}),help:sprintf(w("Modal close button is %s.","wecodeart"),w(d?.modal?.close?"shown":"not shown","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Keyboard control","wecodeart"),checked:d?.modal?.keyboard,onChange:e=>m({...d,modal:{...d?.modal,keyboard:e}}),help:sprintf(w("Modal %s be closed with ESC key.","wecodeart"),w(d?.modal?.keyboard?"can":"cannot","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(N,{label:w("Colors","wecodeart")},(0,e.createElement)(R,{style:{justifyContent:"flex-start"}},(0,e.createElement)(_,{label:w("Background Color","wecodeart"),icon:(0,e.createElement)(T,{colorValue:d?.modal?.style?.backgroundColor}),toggleProps:{style:{height:"initial",minWidth:"initial",padding:0}},popoverProps:{focusOnMount:"container",position:"bottom",noArrow:!1}},(()=>(0,e.createElement)(B,{colors:H,enableAlpha:!0,value:d?.modal?.style?.backgroundColor,onChange:e=>b({backgroundColor:e},"modal")}))),(0,e.createElement)(_,{label:w("Text Color","wecodeart"),icon:(0,e.createElement)(T,{colorValue:d?.modal?.style?.color}),toggleProps:{style:{height:"initial",minWidth:"initial",padding:0}},popoverProps:{focusOnMount:"container",position:"bottom",noArrow:!1}},(()=>(0,e.createElement)(B,{colors:H,enableAlpha:!0,value:d?.modal?.style?.color,onChange:e=>b({color:e},"modal")}))))))))),(0,e.createElement)("div",{className:"g-col-1"},(0,e.createElement)(f,{className:"border shadow-none h-100"},(0,e.createElement)(E,null,(0,e.createElement)("h5",{className:"text-uppercase fw-medium m-0"},w("Toggler","wecodeart"))),(0,e.createElement)(v,{style:{color:"rgb(30, 30, 30)"}},(0,e.createElement)("p",null,(0,e.createElement)(P,{label:w("Position","wecodeart"),value:d?.toggler?.position,options:[{label:w("Left","wecodeart"),value:"left"},{label:w("Right","wecodeart"),value:"right"}],onChange:e=>m({...d,toggler:{...d?.toggler,position:e}}),help:w("Relative to the browser window.","wecodeart"),__nextHasNoMarginBottom:!0})),(0,e.createElement)("p",null,(0,e.createElement)(R,null,(0,e.createElement)(O,{isShiftStepEnabled:!0,spinControls:"custom",label:w("Horizontal Margin","wecodeart"),help:w("Number of pixels for horizontal window distance.","wecodeart"),min:0,value:d?.toggler?.style?.left,onChange:e=>b({left:parseInt(e)},"toggler")}),(0,e.createElement)(O,{isShiftStepEnabled:!0,spinControls:"custom",label:w("Vertical Margin","wecodeart"),help:w("Number of pixels for vertical window distance.","wecodeart"),min:0,value:d?.toggler?.style?.bottom,onChange:e=>b({bottom:parseInt(e)},"toggler")}))),(0,e.createElement)("p",null,(0,e.createElement)(O,{isShiftStepEnabled:!0,spinControls:"custom",label:w("Size","wecodeart"),min:20,value:d?.toggler?.style?.width,onChange:e=>b({width:parseInt(e),height:parseInt(e)},"toggler"),help:w("In pixels.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(O,{isShiftStepEnabled:!0,spinControls:"custom",label:w("Padding","wecodeart"),min:0,value:d?.toggler?.style?.padding,onChange:e=>b({padding:parseInt(e)},"toggler"),help:w("In pixels.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(j,{colors:H,label:w("Border","wecodeart"),value:d?.toggler?.style?.border,onChange:e=>b({border:e},"toggler"),help:w("In pixels.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(S,{label:w("Radius","wecodeart"),allowReset:!0,value:d?.toggler?.style?.borderRadius,onChange:e=>b({borderRadius:e},"toggler"),min:0})),(0,e.createElement)("p",null,(0,e.createElement)(N,{label:w("Colors","wecodeart")},(0,e.createElement)(R,{style:{justifyContent:"flex-start"}},(0,e.createElement)(_,{label:w("Background Color","wecodeart"),icon:(0,e.createElement)(T,{colorValue:d?.toggler?.style?.backgroundColor}),toggleProps:{style:{height:"initial",minWidth:"initial",padding:0}},popoverProps:{focusOnMount:"container",position:"bottom",noArrow:!1}},(()=>(0,e.createElement)(B,{colors:H,enableAlpha:!0,value:d?.toggler?.style?.backgroundColor,onChange:e=>b({backgroundColor:e},"toggler")}))),(0,e.createElement)(_,{label:w("Icon Color","wecodeart"),icon:(0,e.createElement)(T,{colorValue:d?.toggler?.style?.color}),toggleProps:{style:{height:"initial",minWidth:"initial",padding:0}},popoverProps:{focusOnMount:"container",position:"bottom",noArrow:!1}},(()=>(0,e.createElement)(B,{colors:H,enableAlpha:!0,value:d?.toggler?.style?.color,onChange:e=>b({color:e},"toggler")}))))))))),(0,e.createElement)("div",{className:"g-col-1"},(0,e.createElement)(f,{className:"border shadow-none h-100"},(0,e.createElement)(E,null,(0,e.createElement)("h5",{className:"text-uppercase fw-medium m-0"},w("Notifications","wecodeart"))),(0,e.createElement)(v,{style:{color:"rgb(30, 30, 30)"}},(0,e.createElement)("p",null,(0,e.createElement)(M,{label:w("Toast confirmation","wecodeart"),checked:d?.toast?.enable,onChange:e=>m({...d,toast:{...d?.toast,enable:e}}),help:sprintf(w("Toast confirmation messages are %s.","wecodeart"),d?.toast.enable?w("enabled","wecodeart"):w("disabled","wecodeart"))})),(0,e.createElement)("p",null,(0,e.createElement)(O,{label:w("Delay time","wecodeart"),value:d?.toast?.delay,disabled:!d?.toast?.enable,onChange:e=>m({...d,toast:{...d?.toast,delay:e}}),help:w("Duration of the toast message - in miliseconds.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(x,{label:w("Confirm message","wecodeart"),value:d?.toast?.confirm,disabled:!d?.toast?.enable,onChange:e=>m({...d,toast:{...d?.toast,confirm:e}}),help:w("This message is displayed after user accepts cookies.","wecodeart")})),(0,e.createElement)("p",null,(0,e.createElement)(x,{label:w("Reject message","wecodeart"),value:d?.toast?.reject,disabled:!d?.toast?.enable,onChange:e=>m({...d,toast:{...d?.toast,reject:e}}),help:w("This message is displayed after user rejects cookies.","wecodeart")})))))),(0,e.createElement)(l,{formData:d?.toggler}),p&&(0,e.createElement)(u,{formData:d,setFormData:m,createNotice:r,closeModal:()=>g(!1)}),(0,e.createElement)("hr",{style:{margin:"20px 0"}}),(0,e.createElement)(C,{className:"button",isPrimary:!0,isLarge:!0,icon:s&&(0,e.createElement)(k,null),onClick:()=>{i(!0),a({cookies:d},z)},disabled:s},s?"":w("Save","wecodeart")))}})();